# Autoencoder Anomaly Detection PoC

オートエンコーダによる画像異常検知 PoC のためのプログラムです。  
指定フォルダ内のデータでモデルを学習し、MLflow による実験管理・評価結果の可視化を行います。
config.pyで学習の設定を行います。
train.pyは学習を実行する為のプログラムです。学習の過程はMLflowに記録されます。
evaluate.pyは学習済みモデルの推論用プログラムです。testデータでモデルの精度を確認するときに利用します。
augment_app.pyは学習データの水増しが行えます。

# config.py 説明

このリポジトリは、Autoencoder を用いた異常検知のための設定ファイル `config.py` を含んでいます。  
本ファイルでは、モデル構成・学習条件・データパス・MLflow ログ設定・異常検知パラメータを一括管理しています。

## 構成

### 1. モデル構成 (`MODEL_CONFIG`)

Autoencoder モデルの構造に関する設定です。

| パラメータ        | 説明                                                                                 | デフォルト値         |
|--------------------|--------------------------------------------------------------------------------------|-----------------------|
| `input_shape`      | モデルの入力画像サイズ (channels, height, width)。<br>グレースケール画像は `1`、カラーは `3` | `(3, 128, 128)`      |
| `hidden_dims`      | 潜在空間の各層のユニット数。                                                         | `[64, 32, 16]`       |
| `latent_dim`       | ボトルネック層の次元数。                                                             | `32`                 |
| `activation`       | 活性化関数。例: `"ReLU"`, `"Sigmoid"`                                                | `"ReLU"`             |

---

### 2. 学習条件 (`TRAINING_CONFIG`)

モデル学習時のハイパーパラメータ。

| パラメータ        | 説明                                                   | デフォルト値   |
|--------------------|--------------------------------------------------------|----------------|
| `batch_size`       | バッチサイズ                                           | `200`          |
| `epochs`           | 学習エポック数                                        | `50`           |
| `learning_rate`    | 学習率 (Learning Rate)                                | `1e-3`         |
| `optimizer`        | オプティマイザ。例: `"Adam"`, `"SGD"`                  | `"Adam"`       |
| `weight_decay`     | 重み減衰 (L2正則化) の係数                             | `1e-5`         |

---

### 3. データ設定 (`DATA_CONFIG`)

学習・評価に使用するデータセットのパスと前処理に関する設定。

| パラメータ        | 説明                                                                                  | デフォルト値             |
|--------------------|---------------------------------------------------------------------------------------|---------------------------|
| `train_dir`        | 学習データディレクトリのパス                                                         | `./data_ex2/train`       |
| `test_dir`         | テストデータディレクトリのパス                                                       | `./data_ex/test`         |
| `normalize`        | 入力画像を正規化するかどうか (`True`: 正規化する, `False`: 正規化しない)              | `True`                    |
| `image_size`       | 入力画像サイズ (height, width)                                                       | `(128, 128)`             |
| `grayscale`        | 画像をモノクロで扱うか (`True`: モノクロ, `False`: カラー)                             | `False`                   |

---

### 4. MLflow 設定 (`MLFLOW_CONFIG`)

実験管理に MLflow を利用する場合の設定。

| パラメータ          | 説明                                                                                  | デフォルト値                     |
|----------------------|---------------------------------------------------------------------------------------|-----------------------------------|
| `use_mlflow`         | MLflow を使用するかどうか (`True`: 使用する, `False`: 使用しない)                      | `True`                           |
| `experiment_name`    | MLflow の実験名                                                                       | `"Autoencoder_Anomaly_PoC"`      |
| `tracking_uri`       | MLflow Tracking サーバーの URI                                                        | `"http://localhost:8080"`        |

---

### 5. 異常検知設定 (`ANOMALY_CONFIG`)

異常検知のしきい値に関する設定。

| パラメータ           | 説明                                                                                  | デフォルト値        |
|-----------------------|---------------------------------------------------------------------------------------|----------------------|
| `threshold`           | 固定のしきい値 (未設定の場合は `threshold_method` で決定)                             | `None`               |
| `threshold_method`    | しきい値の自動計算方法。例: `"mean+3std"`, `"percentile_95"`                          | `"mean+3std"`        |

---